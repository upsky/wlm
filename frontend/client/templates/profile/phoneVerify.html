<template name="phoneVerify">
    {{#Layout template="panel" data=phoneField}}
        {{#autoForm id="phoneField" type=formType meteormethod="updateProfile" schema="Schemas.phoneField" }}
            <div class="form-group {{#if afFieldIsInvalid name='phone'}} has-error{{/if}}">
                <label class="control-label">{{_ "formFields.phone.label"}}</label>

                {{#if phoneExist}}
                    {{#if phoneVerified}}
                        <span class="label label-success">{{_ "fieldStatus.confirmed"}}</span>
                    {{else}}
                        <span class="label label-danger">{{_ "fieldStatus.notConfirmed"}}</span>
                    {{/if}}
                    <a href="#" id="delete-number" class="pull-right">{{_ "messages.removeCurrentPhone"}}</a>
                {{/if}}

                <div class="input-group">
                    <div class="input-group-addon">+7</div>
                    {{> afFieldInput type="tel" class="form-control" readonly="readonly" name="phone" value=user.profile.phones.[0].number}}
                </div>
                {{#if afFieldIsInvalid name='phone'}}
                    <span class="help-block">{{afFieldMessage name='phone'}}</span>
                {{/if}}
            </div>
            {{#unless phoneExist}}
                <button type="submit" class="btn btn-success">{{_ "buttons.save"}}</button>
            {{/unless}}

            {{#if phoneExist}}
                {{#unless phoneVerified}}
                    <span class="help-block">
                            {{_ "messages.phoneNoteVerify"}}
                        <a href="#" id="send-phone-verification">{{_ "messages.reSendCode"}}</a>.
                        </span>
                {{/unless}}
            {{/if}}
        {{/autoForm}}

        {{#if phoneExist}}
            {{#unless phoneVerified}}
                {{#autoForm id="verifyPhone" type="method" meteormethod="checkVerifyCodePhone" schema="Schemas.verifyPhone" }}
                    {{> afQuickField type="tel" class="form-control" name="verificationCode" }}

                    <button type="submit" class="btn btn-success">{{_ "buttons.save"}}</button>
                {{/autoForm}}
            {{/unless}}
        {{/if}}
    {{/Layout}}
</template>